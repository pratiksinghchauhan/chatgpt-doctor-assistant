(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{8312:function(e,s,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return a(5821)}])},5821:function(e,s,a){"use strict";a.r(s),a.d(s,{default:function(){return y}});var n=a(5893),o=a(7294);function r(e){let{children:s}=e;return(0,n.jsxs)("div",{className:"mx-auto flex flex-col space-y-4",children:[(0,n.jsx)("header",{className:"container sticky top-0 z-40 bg-white",children:(0,n.jsx)("div",{className:"h-16 border-b border-b-slate-200 py-4",children:(0,n.jsx)("nav",{className:"ml-4 pl-6",children:(0,n.jsx)("a",{href:"#",className:"hover:text-slate-600 cursor-pointer",children:"Home"})})})}),(0,n.jsx)("div",{className:"container",children:(0,n.jsx)("main",{className:"flex w-full flex-1 flex-col overflow-hidden",children:s})})]})}var t=a(8122),l=a.n(t),i=a(1375),c=a(5675),d=a.n(c),m=a(4740),u=a(4871),g=a.n(u);let h=e=>{let{color:s="#000",style:a="small"}=e;return(0,n.jsxs)("span",{className:"small"==a?g().loading2:g().loading,children:[(0,n.jsx)("span",{style:{backgroundColor:s}}),(0,n.jsx)("span",{style:{backgroundColor:s}}),(0,n.jsx)("span",{style:{backgroundColor:s}})]})};h.defaultProps={style:"small"};var _=a(1683),p=a(9307),x=a(6010),f=a(6180);function j(){for(var e=arguments.length,s=Array(e),a=0;a<e;a++)s[a]=arguments[a];return(0,f.m)((0,x.W)(s))}let v=_.fC,N=o.forwardRef((e,s)=>{let{className:a,...o}=e;return(0,n.jsx)(_.ck,{ref:s,className:j("border-b border-b-slate-200 dark:border-b-slate-700",a),...o})});N.displayName="AccordionItem";let b=o.forwardRef((e,s)=>{let{className:a,children:o,...r}=e;return(0,n.jsx)(_.h4,{className:"flex",children:(0,n.jsxs)(_.xz,{ref:s,className:j("flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180",a),...r,children:[o,(0,n.jsx)(p.Z,{className:"h-4 w-4 transition-transform duration-200"})]})})});b.displayName=_.xz.displayName;let w=o.forwardRef((e,s)=>{let{className:a,children:o,...r}=e;return(0,n.jsx)(_.VY,{ref:s,className:j("data-[state=open]:animate-accordion-down data-[state=closed]:animate-accordion-up overflow-hidden text-sm transition-all",a),...r,children:(0,n.jsx)("div",{className:"pt-0 pb-4",children:o})})});function y(){let[e,s]=(0,o.useState)(""),[a,t]=(0,o.useState)(!1),[c,u]=(0,o.useState)([]),[g,_]=(0,o.useState)(null),[p,x]=(0,o.useState)({messages:[{message:"Hi Doctor, What would you like to learn today ?",type:"apiMessage"}],history:[],pendingSourceDocs:[]}),{messages:f,pending:j,history:y,pendingSourceDocs:H}=p,k=(0,o.useRef)(null),D=(0,o.useRef)(null);async function S(a){if(a.preventDefault(),_(null),!e){alert("Please input a question");return}let n=e.trim();x(e=>({...e,messages:[...e.messages,{type:"userMessage",message:n}],pending:void 0})),t(!0),s(""),x(e=>({...e,pending:""}));let o=new AbortController;try{(0,i.L)("/api/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({question:n,history:y}),signal:o.signal,onmessage:e=>{var s,a,r;if("[DONE]"===e.data)x(e=>({history:[...e.history,[n,null!==(s=e.pending)&&void 0!==s?s:""]],messages:[...e.messages,{type:"apiMessage",message:null!==(a=e.pending)&&void 0!==a?a:"",sourceDocs:e.pendingSourceDocs}],pending:void 0,pendingSourceDocs:void 0})),t(!1),o.abort();else{let s=JSON.parse(e.data);s.sourceDocs?x(e=>({...e,pendingSourceDocs:s.sourceDocs})):x(e=>({...e,pending:(null!==(r=e.pending)&&void 0!==r?r:"")+s.data}))}}})}catch(e){t(!1),_("An error occurred while fetching the data. Please try again."),console.log("error",e)}}(0,o.useEffect)(()=>{var e;null===(e=D.current)||void 0===e||e.focus()},[]);let C=(0,o.useCallback)(s=>{"Enter"===s.key&&e?S(s):"Enter"==s.key&&s.preventDefault()},[e]),P=(0,o.useMemo)(()=>[...f,...j?[{type:"apiMessage",message:j,sourceDocs:H}]:[]],[f,j,H]);return(0,o.useEffect)(()=>{k.current&&(k.current.scrollTop=k.current.scrollHeight)},[P]),(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)(r,{children:[(0,n.jsxs)("div",{className:"mx-auto flex flex-col gap-4",children:[(0,n.jsx)("h1",{className:"text-2xl font-bold leading-[1.1] tracking-tighter text-center",children:"Livingo Doctor Assistant"}),(0,n.jsxs)("main",{className:l().main,children:[(0,n.jsx)("div",{className:l().cloud,children:(0,n.jsxs)("div",{ref:k,className:l().messagelist,children:[P.map((e,s)=>{let o,r;return"apiMessage"===e.type?(o=(0,n.jsx)(d(),{src:"/bot-image.png",alt:"AI",width:"40",height:"40",className:l().boticon,priority:!0}),r=l().apimessage):(o=(0,n.jsx)(d(),{src:"/usericon.png",alt:"Me",width:"30",height:"30",className:l().usericon,priority:!0}),r=a&&s===P.length-1?l().usermessagewaiting:l().usermessage),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:r,children:[o,(0,n.jsx)("div",{className:l().markdownanswer,children:(0,n.jsx)(m.D,{linkTarget:"_blank",children:e.message})})]},"chatMessage-".concat(s)),e.sourceDocs&&(0,n.jsx)("div",{className:"p-5",children:(0,n.jsx)(v,{type:"single",collapsible:!0,className:"flex-col",children:e.sourceDocs.map((e,s)=>(0,n.jsx)("div",{children:(0,n.jsxs)(N,{value:"item-".concat(s),children:[(0,n.jsx)(b,{children:(0,n.jsxs)("h3",{children:["Source ",s+1]})}),(0,n.jsxs)(w,{children:[(0,n.jsx)(m.D,{linkTarget:"_blank",children:e.pageContent}),(0,n.jsxs)("p",{className:"mt-2",children:[(0,n.jsx)("b",{children:"Source:"})," https://livingo.s3.amazonaws.com/media/discharge_sheets/",e.metadata.path]})]})]})},"messageSourceDocs-".concat(s)))})})]})}),c.length>0&&(0,n.jsx)("div",{className:"p-5",children:(0,n.jsx)(v,{type:"single",collapsible:!0,className:"flex-col",children:c.map((e,s)=>(0,n.jsx)("div",{children:(0,n.jsxs)(N,{value:"item-".concat(s),children:[(0,n.jsx)(b,{children:(0,n.jsxs)("h3",{children:["Source ",s+1]})}),(0,n.jsx)(w,{children:(0,n.jsx)(m.D,{linkTarget:"_blank",children:e.pageContent})})]})},"sourceDocs-".concat(s)))})})]})}),(0,n.jsx)("div",{className:l().center,children:(0,n.jsx)("div",{className:l().cloudform,children:(0,n.jsxs)("form",{onSubmit:S,children:[(0,n.jsx)("textarea",{disabled:a,onKeyDown:C,ref:D,autoFocus:!1,rows:1,maxLength:512,id:"userInput",name:"userInput",placeholder:a?"Waiting for response...":"Lets discuss about your case here?",value:e,onChange:e=>s(e.target.value),className:l().textarea}),(0,n.jsx)("button",{type:"submit",disabled:a,className:l().generatebutton,children:a?(0,n.jsx)("div",{className:l().loadingwheel,children:(0,n.jsx)(h,{color:"#000"})}):(0,n.jsx)("svg",{viewBox:"0 0 20 20",className:l().svgicon,xmlns:"http://www.w3.org/2000/svg",children:(0,n.jsx)("path",{d:"M10.894 2.553a1 1 0 00-1.788 0l-7 14a1 1 0 001.169 1.409l5-1.429A1 1 0 009 15.571V11a1 1 0 112 0v4.571a1 1 0 00.725.962l5 1.428a1 1 0 001.17-1.408l-7-14z"})})})]})})}),g&&(0,n.jsx)("div",{className:"border border-red-400 rounded-md p-4",children:(0,n.jsx)("p",{className:"text-red-500",children:g})})]})]}),(0,n.jsx)("footer",{className:"m-auto p-4",children:(0,n.jsx)("a",{href:"https://twitter.com/mayowaoshin",children:"Powered by ChatGPT. Demo built by Livingo."})})]})})}w.displayName=_.VY.displayName},8122:function(e){e.exports={main:"Home_main__nLjiQ",header:"Home_header__GCVRv",cloudform:"Home_cloudform__W4PLJ",textarea:"Home_textarea__lSHf7",generatebutton:"Home_generatebutton__omKYX",loadingwheel:"Home_loadingwheel__IWJnE",svgicon:"Home_svgicon__PLaWz",messagelist:"Home_messagelist__YHr8p",messagelistloading:"Home_messagelistloading__tlCYV",usermessage:"Home_usermessage__tWHWR",usermessagewaiting:"Home_usermessagewaiting__PYv_4","loading-gradient":"Home_loading-gradient__8jpVG",apimessage:"Home_apimessage__VhfTn",fadein:"Home_fadein__CBLON",markdownanswer:"Home_markdownanswer__UUDfu",boticon:"Home_boticon__Xr0Q4",usericon:"Home_usericon___BrVD",center:"Home_center__4BFgC",cloud:"Home_cloud__S7par",pointsnormal:"Home_pointsnormal__yRwA_",pointsdim:"Home_pointsdim__x_zcw",footer:"Home_footer____T7K",topnav:"Home_topnav__BfkuW",navlogo:"Home_navlogo__AhPAx"}},4871:function(e){e.exports={loading:"loading-dots_loading__LomzL",spacer:"loading-dots_spacer__nBBvk",blink:"loading-dots_blink__yy72w",loading2:"loading-dots_loading2___zCAu"}}},function(e){e.O(0,[955,774,888,179],function(){return e(e.s=8312)}),_N_E=e.O()}]);